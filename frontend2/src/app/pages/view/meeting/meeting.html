<div class="card">
    <p-toast position="top-right"></p-toast>
    <div class="font-semibold text-xl mb-4">Meeting Details</div>
    <p-splitter [style]="{ height: '800px' }" [panelSizes]="[70, 30]" [minSizes]="[10, 0]" styleClass="mb-8">
        <ng-template #panel>
            <p-splitter layout="vertical" [panelSizes]="[20, 80]">
                <ng-template #panel>
                    <div class="w-full p-6 bg-surface-0 dark:bg-surface-900 rounded flex justify-between items-center">
                        <p-image src="{{ patient.photoUrl }}" alt="Image" width="150" />

                        <div class="flex flex-col gap-4 ml-6 flex-1">
                            <div class="flex flex-row justify-between items-start gap-2">
                                <div>
                                    <span class="font-medium text-surface-500 dark:text-surface-400 text-sm">{{ patient.name }}</span>
                                    <div class="text-lg font-medium mt-1">
                                        {{ patient.surname }}
                                    </div>
                                </div>
                            </div>

                            <div class="flex flex-col gap-2">
                                <div>
                                    <span class="font-medium text-surface-500 dark:text-surface-400 text-sm">Meeting Time: {{ meeting.startTime | date: 'HH:mm' }}</span>
                                    <div class="text-lg font-medium mt-1">
                                        Meeting Date: {{ meeting.date | date:'yyyy-MM-dd' }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex gap-4 items-center">
                            <p-button
                                *ngIf="!isEditMode"
                                label="Edit"
                                icon="pi pi-user-edit"
                                severity="secondary"
                                raised
                                (click)="enterEdit()"
                            ></p-button>

                            <p-button
                                *ngIf="isEditMode"
                                label="Save"
                                icon="pi pi-save"
                                raised
                                (click)="saveMeeting()"
                            ></p-button>

                            <p-button
                                *ngIf="isEditMode"
                                label="Cancel"
                                icon="pi pi-times"
                                severity="warn"
                                raised
                                (click)="cancelEdit()"
                            ></p-button>

                            <p-button
                                *ngIf="isEditMode && !isNewMeetingMode"
                                label="Delete"
                                icon="pi pi-trash"
                                severity="danger"
                                raised
                                (click)="openConfirmDialog()"
                            ></p-button>

                            <p-dialog header="Confirmation" [(visible)]="displayConfirmDialog" [style]="{ width: '350px' }" [modal]="true">
                                <div class="flex items-center justify-center">
                                    <i class="pi pi-exclamation-triangle mr-4" style="font-size: 2rem"> </i>
                                    <span>Are you sure you want to delete meeting?</span>
                                </div>
                                <ng-template #footer>
                                    <p-button label="No" icon="pi pi-times" (click)="closeConfirmDialog()" text severity="secondary" />
                                    <p-button label="Yes" icon="pi pi-check" (click)="deleteMeeting()" severity="danger" outlined autofocus />
                                </ng-template>
                            </p-dialog>

                        </div>
                    </div>
                </ng-template>
                <ng-template #panel>
                    <p-splitter [panelSizes]="[40,60]">
                        <ng-template #panel>
                            <div class="card flex flex-col gap-4">
                                <div class="font-semibold text-xl flex items-center justify-center">Info</div>
                                <div class="flex flex-col gap-2">
                                    <label for="name1">Name</label>
                                    <input pInputText id="name1" type="text" [(ngModel)]="patient.name" [disabled]="!isNewMeetingMode" />
                                </div>

                                <div class="flex flex-col gap-2">
                                    <label for="name1">Surname</label>
                                    <input pInputText id="name1" type="text" [(ngModel)]="patient.surname" [disabled]="!isNewMeetingMode" />
                                </div>

                                <div class="flex flex-col gap-2">
                                    <label>Date</label>
                                    <p-datepicker
                                        [(ngModel)]="meeting.date"
                                        [disabled]="!isEditMode"
                                        [showIcon]="true"
                                        [showButtonBar]="true"
                                        dateFormat="yy MM dd"
                                        inputId="datePicker">
                                    </p-datepicker>
                                </div>

                                <div class="flex flex-col gap-2">
                                    <label for="surname1">Time</label>
                                    <p-datepicker inputId="calendar-timeonly" [(ngModel)]="meeting.startTime" [timeOnly]="true" [disabled]="!isEditMode"></p-datepicker>
<!--                                    <input pInputText id="surname1" type="text" [(ngModel)]="meeting.startTime" [disabled]="!isEditMode" />-->
                                </div>

                                <div class="flex flex-col gap-2">
                                    <label for="email1">Minutes</label>
                                    <p-inputnumber [(ngModel)]="meeting.duration" [disabled]="!isEditMode" showButtons mode="decimal"></p-inputnumber>
                                </div>

<!--                                < TODO: div class="flex flex-col gap-2">-->
<!--                                    <div>Rating</div>-->
<!--                                    <p-rating [(ngModel)]="meeting.ratingValue" [disabled]="!isEditMode"/>-->
<!--                                </div>-->
                            </div>
                        </ng-template>
                        <ng-template #panel>
                            <div class="card flex flex-col gap-4">
                                <div class="col flex items-center justify-center font-semibold text-xl">Notes</div>
                                <textarea
                                    pTextarea placeholder="Meeting notes here..."
                                    [autoResize]="true"
                                    rows="25"
                                    cols="30"
                                    [(ngModel)]="meeting.notes"
                                    [disabled]="!isEditMode"
                                ></textarea>
                            </div>
                        </ng-template>
                    </p-splitter>
                </ng-template>
            </p-splitter>
        </ng-template>
        <ng-template #panel>
            <p-splitter layout="vertical" [panelSizes]="[40, 60]">
                <ng-template #panel>
                    <div class="card">
                        <p-table [value]="customers2" [scrollable]="true" scrollHeight="250px" styleClass="mt-4">
                            <ng-template #header>
                                <tr>
                                    <th class="text-xl" style="min-width:300px">Suggested Exercises</th>
                                </tr>
                            </ng-template>
                            <ng-template #body let-customer>
                                <tr
                                    class="hover-scale cursor-pointer"
                                    [routerLink]="['/view','exercise']">
                                    <td style="min-width:100px">{{ customer.id }}</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </ng-template>
                <ng-template #panel>
                    <div class="card">
                        <p-table [value]="customers2" [scrollable]="true" scrollHeight="400px" styleClass="mt-4">
                            <ng-template #header>
                                <tr>
                                    <th class="text-xl" style="min-width:300px">Currently Planned Exercises</th>
                                </tr>
                            </ng-template>
                            <ng-template #body let-customer>
                                <tr class="hover-scale cursor-pointer"
                                [routerLink]="['/view','exercise']"
                                >
                                    <td style="min-width:100px">{{ customer.id }}</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </ng-template>
            </p-splitter>
        </ng-template>
    </p-splitter>
</div>
